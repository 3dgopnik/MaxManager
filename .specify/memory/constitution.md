# MaxManager Constitution

## Core Principles

### I. Модульная архитектура
Каждая фича начинается с отдельного модуля:
- Модули должны быть самодостаточными и независимо тестируемыми
- Четкое назначение обязательно - никаких "организационных" модулей
- Каждый модуль документирован с примерами использования

### II. Python + MaxScript интеграция
Основной код на Python, интеграция с 3ds Max через MaxScript:
- Python: бизнес-логика, UI (Qt/PySide6), конфигурация
- MaxScript: интеграция с 3ds Max, макросы, UI в Max
- Четкое разделение ответственности между Python и MaxScript

### III. Test-First (ОБЯЗАТЕЛЬНО)
TDD обязателен для Python кода:
- Тесты написаны → Одобрены пользователем → Тесты падают → Реализация
- Red-Green-Refactor цикл строго соблюдается
- MaxScript: тестирование через пользователя (ручное)

### IV. Интеграция с 3ds Max
Фокус на интеграции:
- MaxScript макросы автоматически копируются в пользовательскую папку 3ds Max
- Стандартный путь: `%USERPROFILE%/AppData/Local/Autodesk/3dsMax/<YEAR> - 64bit/Scripts/MaxManager/`
- Версионирование скриптов в заголовке файла
- Автоматическая регистрация макросов и иконок

### V. Качество кода
SOLID, KISS, DRY обязательны:
- Ruff + Ruff format для форматирования
- Mypy (strict-ish) для type hints
- Pre-commit hooks для автоматических проверок
- Полные type hints и docstrings для всего Python кода
- Никакого мертвого кода и неиспользуемых комментариев

### VI. Документация
Документация на русском, код на английском:
- README.md: установка, быстрый старт, основные функции
- /docs: changelog, tasktracker, project, спецификации
- Код и комментарии в коде: только английский
- Все изменения отражаются в документации

### VII. GitHub Integration
Все задачи = GitHub Issues:
- Каждая задача начинается с Issue
- Все шаги фиксируются в комментариях к Issue
- Issue закрывается только после разрешения пользователя
- PR привязывается к Issue через "Closes #N"
- Используются только MCP GitHub tools

## Git Workflow

### Локальная разработка
- Исправления фиксируются через `git commit` ЛОКАЛЬНО
- ЗАПРЕЩЕНО делать `git push` сразу после commit
- Пользователь ОБЯЗАН протестировать изменения ДО push
- Итеративные исправления: баг → fix → commit → test → fix...

### Финальный push
- ТОЛЬКО после успешного тестирования и явного разрешения пользователя
- Один финальный комментарий в Issue с полным результатом
- Чистая история: избегать мусорных коммитов через `--amend` или squash
- Issue закрывается после финального push и подтверждения

### Ветки
- Основная работа в main
- Ветки создаются только для особо важных фич
- Формат веток: `feature/short-name` или `fix/short-name`

## Tech Stack

### Backend (Python)
- Python 3.10+
- PySide6 для GUI
- Структурированное логирование
- Конфигурация через YAML/JSON

### Frontend (3ds Max)
- MaxScript для макросов и интеграции
- Категория макросов: `MaxManager`
- Автоматическая регистрация иконок

### UI Libraries
- **PySide6-Fluent-Widgets** - современный Fluent Design интерфейс (основная библиотека)
- **QFluentWidgets** - профессиональные компоненты (карточки, навигация, анимации)
- **Remix Icons** - иконки для интерфейса
- **QDarkStyleSheet** - темная тема (fallback)
- **Qt Material** - материальный дизайн (опционально)
- **Context7** - актуальная документация библиотек через MCP

### Интеграция
- Cerebro API для управления проектами
- File system integration для структуры проектов
- GitHub API через MCP tools

## Quality Gates

### Перед коммитом
- [ ] Все изменения через MCP инструменты или стандартные tools
- [ ] Issue создан через `mcp_github_create_issue`
- [ ] Документация обновлена
- [ ] Type hints и docstrings добавлены
- [ ] Ruff/Mypy проверки пройдены
- [ ] Pre-commit hooks зелёные

### Перед push
- [ ] Пользователь протестировал изменения
- [ ] Все баги исправлены локально
- [ ] История коммитов чистая
- [ ] Финальный комментарий в Issue с результатами
- [ ] Явное разрешение пользователя на push

### Перед закрытием Issue
- [ ] PR создан и смержен (если есть)
- [ ] Документация обновлена (/docs)
- [ ] Пользователь подтвердил успешную работу
- [ ] Все чек-листы пройдены

## Development Workflow

### Новая фича
1. Создать Issue через `mcp_github_create_issue`
2. Создать спецификацию через `/MaxManager/speckit.specify`
3. Валидация спецификации (checklist)
4. Создать план через `/MaxManager/speckit.plan`
5. Разбить на задачи через `/MaxManager/speckit.tasks`
6. Реализация через `/MaxManager/speckit.implement`
7. Локальные коммиты + тестирование пользователем
8. Финальный push после разрешения
9. Закрытие Issue после подтверждения

### Исправление бага
1. Создать Issue с описанием бага
2. Локальное исправление + commit
3. Тестирование пользователем
4. Итеративные фиксы (если нужно)
5. Финальный push после разрешения
6. Закрытие Issue

## Governance

### Приоритеты
1. Работающий код > идеальный код
2. Тестирование пользователем > автотесты (для MaxScript)
3. Документация = код (одинаковая важность)
4. Чистая история > быстрые коммиты

### Правила изменений
- Constitution supersedes все остальные практики
- Изменения в Constitution требуют документирования и одобрения
- Все PR/reviews должны проверять соответствие Constitution
- Сложность должна быть обоснована

### Коммуникация
- Общение на русском, код на английском
- Дружественный тон + немного матов по делу
- Краткие ответы: минимум слов, максимум смысла
- Всегда указывать используемую модель AI

**Version**: 1.0.0 | **Ratified**: 2025-10-17 | **Last Amended**: 2025-10-17
