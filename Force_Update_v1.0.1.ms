/*
 * Force Update Advanced MaxINI Editor v1.0.1
 * Description: Forces update of Advanced Editor with API fix
 */

try (
    clearListener()
    format "\n=== FORCE UPDATE Advanced MaxINI Editor v1.0.1 ===\n\n"
    
    -- Force copy updated Advanced Editor
    local editorSource = "C:\\MaxManager\\src\\ui\\maxini_editor_advanced.py"
    local editorTarget = (getdir #maxdata) + "scripts\\MaxManager\\src\\ui\\maxini_editor_advanced.py"
    
    format "ğŸ”§ Force copying Advanced Editor v1.0.1...\n"
    if doesFileExist editorSource then (
        copyFile editorSource editorTarget
        format "âœ… Advanced Editor v1.0.1 force updated\n"
        format "ğŸ“ Target: %\n" editorTarget
    ) else (
        format "âŒ ERROR: Source not found: %\n" editorSource
        throw "Force update failed"
    )
    
    -- Verify file was updated
    if doesFileExist editorTarget then (
        local fileInfo = getFileModDate editorTarget
        format "âœ… File updated at: %\n" fileInfo
    )
    
    format "\n=== FORCE UPDATE COMPLETE! ===\n"
    format "ğŸ¯ Advanced Editor v1.0.1 with API fix is now installed\n"
    format "ğŸ”§ Fixed: maxscript.evaluate â†’ pymxs.runtime\n"
    format "ğŸ“‹ Next: Restart 3ds Max and test Advanced Editor\n\n"
    
    messageBox "FORCE UPDATE v1.0.1 COMPLETE!\n\nğŸ¯ Advanced Editor v1.0.1 with API fix installed\nğŸ”§ Fixed: maxscript.evaluate â†’ pymxs.runtime\nğŸ“‹ Restart 3ds Max and test!" title:"Force Update Complete" beep:false
    
) catch (
    local errorMsg = getCurrentException()
    format "\nâŒ FORCE UPDATE FAILED: %\n" errorMsg
    messageBox ("FORCE UPDATE FAILED!\n\n" + errorMsg) title:"Force Update Error"
)
